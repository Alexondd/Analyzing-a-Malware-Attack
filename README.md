# Analyzing-a-Malware-Attack
How to analyze the data of a malware attack to identify how the malware spreads. How to find patterns used by the attacker so that you can prepare a firewall rule to stop the spread of the virus.
# Context for this project (refer to Triage A Malware Threat before attempting)
Now that you have notified the infrastructure owner of the current attack, analyse the firewall logs to find the pattern in the attacker’s network requests. You won’t be able to simply block IP addresses, because of the distributed nature of the attack, but maybe there is another characteristic of the request that is easy to block.

An important responsibility of an information security analyst is the ability to work across disciplines with multiple teams, both technical and non-technical.

In the resource folder, there's an attached proof of concept payload that may be of interest in understanding how the attacker scripted this attack.
# Task
First, analyze the firewall logs in the resource folder.

Next, identify what characteristics of the Spring4Shell vulnerability have been used.

Finally, draft an email to the networks team with your findings. Make sure to be concise, so that they can develop the firewall rule to mitigate the attack. You can assume the recipient is technical and has dealt with these types of requests before.
# Guide to Analyzing Firewall Logs to Identify Attack Patterns
1. **Review the logs:**
- Look at the firewall logs and note any unusual or suspicious activities.
- Focus on entries that involve bypass actions or repeated access attempts (as per CISA advisory).
2. **Identify Common Elements:**
- Confirm if there are multiple entries from different IP addresses that seem related.
- Look for common request paths, such as URLs or endpoints being targeted frequently (e.g., /tomcatwar.jsp).
3. **Analyze the Request Method:**
- Identify the HTTP methods used in the suspicious requests. In this case, the method used is POST.
- Note any methods that are typically used for sending data to the server (e.g., POST).
4. **Examine the Payload:**
- Look at the data being sent in the requests. Malicious payloads often contain encoded or suspicious-looking data.
- In the logs, the payload includes patterns like class.module.classLoader.resources.context.parent.pipeline.first.pattern.
5. **Summarize the Attack Pattern:**
- Combine your observations to describe the attack. For example:

  - Request Method: POST
  - Targeted Path: /tomcatwar.jsp
  - Payload Characteristics: Contains encoded data exploiting the class loader.
 
**Example Pattern Identified:**
- Request Method: POST
- Targeted Path: /tomcatwar.jsp
- Payload: Includes patterns like class.module.classLoader.resources.context.parent.pipeline.first.pattern
   
**Why This is Important:**
Identifying common characteristics in the attacker's requests helps you create firewall rules to block these specific patterns. This approach is more effective than blocking individual IP addresses, especially in distributed attacks. Finding patterns in attacks allows for targeted and effective mitigation.
